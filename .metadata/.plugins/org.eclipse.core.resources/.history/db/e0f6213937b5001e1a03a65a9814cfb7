<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>
<form action="cart" method="post">
									    <input type="hidden" name="action" value="increment">
									    <input type="hidden" name="itemId" value="<%=cartItem.getItemId()%>">
									    <input type="hidden" name="originalQty_<%=cartItem.getItemId()%>" value="<%=cartItem.getQuantity()%>">
									    <input type="submit" value="+">
									</form>
									
									<form action="cart" method="post">
									    <input type="hidden" name="itemId" value="<%=cartItem.getItemId()%>">
									    <input type="text" name="displayQty_<%=cartItem.getItemId()%>" value="<%= (session.getAttribute("displayQty_" + cartItem.getItemId()) != null) ? session.getAttribute("displayQty_" + cartItem.getItemId()) : 1 %>" readonly>
									</form>
									
									<form action="cart" method="post">
									    <input type="hidden" name="action" value="decrement">
									    <input type="hidden" name="itemId" value="<%=cartItem.getItemId()%>">
									    <input type="hidden" name="originalQty_<%=cartItem.getItemId()%>" value="<%=cartItem.getQuantity()%>">
									    <input type="submit" value="-">
									</form>
									<%
    // Assuming you have user details in the session
    User user = (User) session.getAttribute("user");
    String username = user.getUsername();
    String email = user.getEmail();

    // Get the address from the user input (replace "userInputAddress" with the actual attribute name)
    String address = request.getParameter("userInputAddress");

    // Get the total amount from the OrderServlet (replace "totalAmount" with the actual attribute name)
    int totalAmount = (int) request.getAttribute("totalAmount");
    int restaurantId = Integer.parseInt(request.getParameter("restaurantId"));

    // Populate the order details
    Order order = new Order();
    order.setUserid(user.getUserId()); // Assuming you have a getUserId() method in the User class
    order.setRestaurentid(restaurantId); // Replace with the actual restaurant ID
    order.setTotalamount(totalAmount);
    order.setStatus("Pending");
    order.setPaymentmethod("UPI");

    // Save the order to the database
    OrderDaoImpl orderDao = new OrderDaoImpl();
    orderDao.updateOrder(order);
%>
</body>
</html>
		    
		    
		    
		    <%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ page import="com.foodDelivaryApp.model.Order" %>
<%@ page import="com.foodDelivaryApp.model.User" %>

<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Order Now</title>
    <link rel="stylesheet" href="CSS/OrderNow.css" type="text/css">
</head>
<body>
	<% 
            Order order = (Order) request.getAttribute("order");
            Boolean isLoggedIn = (Boolean) session.getAttribute("isLoggedIn");
        %>
    <h1>Order Now</h1>

    <!-- Progress Bar -->
    <div class="progress-bar">
        <div class="progress-step completed">Login/Sign Up</div>
        <div class="progress-step">Total Amount</div>
        <div class="progress-step">Payment Method</div>
        <div class="progress-step">Confirm Order</div>
    </div>

    <!-- Step 1: Login/Sign Up -->
    <div class="step step-1 <% if(isLoggedIn) { %>active<% } %>">
	    <h2>Account</h2>
	    <p>To place your order now, log in to your existing account or sign up.</p>
	    <div class="buttons-container">
	        <button onclick="window.location.href='<%= request.getContextPath() %>/login.jsp'">Log In</button>
	        <button onclick="window.location.href='<%= request.getContextPath() %>/SignUp'">Sign Up</button>
	    </div>
	    <div class="image-container">
	        <img src="path/to/your/image.jpg" alt="Account Image">
	    </div>
	</div>

    <div class="step step-2">
	    <h2>Total Amount</h2>
	    <p>Enter your delivery address to calculate the total amount.</p>
	    <div class="address-input">
	        <label for="address">Delivery Address:</label>
	        <input type="text" id="address" name="address" placeholder="Enter your address" required>
	    </div>
	</div>

    <!-- Step 3: Payment Method -->
    <div class="step step-3">
        <label for="paymentMethod">Payment Method:</label>
        <select id="paymentMethod" name="paymentMethod" required>
            <option value="GPay">GPay</option>
            <option value="PhonePe">PhonePe</option>
            <option value="Paytm">Paytm</option>
        </select>
        <button onclick="nextStep(4)">
            Next
        </button>
    </div>

    <!-- Step 4: Confirm Order -->
    <div class="step step-4">
        <button onclick="confirmOrder()">
            Confirm Order
        </button>
    </div>

    <!-- Modal -->
    <div id="myModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h2>Please Sign In or Sign Up</h2>
            <a href="signIn.jsp">Sign In</a>
        </div>
    </div>

    <!-- Include your JavaScript files here -->
    <script>
        function openModal() {
            var modal = document.getElementById("myModal");
            modal.style.display = "block";
        }

        function closeModal() {
            var modal = document.getElementById("myModal");
            modal.style.display = "none";
        }

        function nextStep(step) {
            // Hide current step
            var currentStep = document.querySelector('.step.active');
            currentStep.classList.remove('active');

            // Show next step
            var nextStep = document.querySelector('.step-' + step);
            nextStep.classList.add('active');

            // Update progress bar
            var progressSteps = document.querySelectorAll('.progress-step');
            for (var i = 0; i < progressSteps.length; i++) {
                if (i < step - 1) {
                    progressSteps[i].classList.add('completed');
                } else {
                    progressSteps[i].classList.remove('completed');
                }
            }
        }

        function confirmOrder() {
            window.location.href = "OrderConfirmationServlet";
        }
    </script>
</body>
</html>
		    